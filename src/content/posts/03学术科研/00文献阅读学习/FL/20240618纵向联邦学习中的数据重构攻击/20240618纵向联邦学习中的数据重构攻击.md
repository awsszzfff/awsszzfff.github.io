---
title: "20240618纵向联邦学习中的数据重构攻击"
date: 2024-10-21
tags:
  - Others
categories:
  - Others
---
# 20240618垂直联邦学习中的数据重构攻击

# 基础信息

| 类型  | 篇名                                                              | 关键字                                                                                                                                          | 作者                                                          | 来源    | 年份        | 页码  |
| --- | --------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------- | ----- | --------- | --- |
|     | UIFV: Data Reconstruction Attack in Vertical Federated Learning | Vertical federated learning, privacy risks, data leakage, Unified InverNet Framework (UIFV), data reconstruction, intermediate feature data. | Jirui Yang, Peng Chen, Zhihui Lu, Qiang Duan and Yubing Bao | arXiv | 2024/6/18 | 13  |
# 重要信息

## 创新与方案

传统的基于梯度或模型信息的数据重构方法，通常依赖于特定的模型结构或应用情景，其在 VFL 应用场景中存在局限性。文章**直接利用 VFL 过程中产生的中间特征数据来进行攻击**。

提出一种新的垂直联邦学习（VFL）数据重构攻击方法，该方法**不依赖于梯度信息或模型细节，而是通过逆向网络（InverNet）利用目标模型输出的中间特征数据来重构原始数据**。

提出了名为统一逆向网络框架（Unified InverNet Framework, UIFV）的攻击框架，适用于**各种黑盒攻击场景**，并且能够针对具有不同能力的对手进行有效的数据重构攻击。

利用 VFL 被动方模型的中间特征重构数据，将其视为黑盒，大大拓宽了应用场景，增强了 VFL 数据重构攻击的灵活性和适用性。

## Method

第一阶段：数据准备+模型准备；
第二阶段：利用第一阶段准备的数据和模型，训练 InverNet 网络，实现数据的中间重构，得到模型；
第三阶段：私人数据通过第二阶段得到的 InverNet，重构数据。

![[attachments/Pasted image 20241022165346.png]]
图 1：VFL 中统一的 InverNet 框架

- **UIFV 框架的设计**：应用于多种 VFL 场景，并且从不同的对手能力进行考量。摆脱了对梯度信息或模型细节的依赖，从而提供更加灵活有效的数据重构攻击手段。

- **逆向网络（InerNet）的构建**：创建了一个逆向网络**用于从目标模型输出的中间特征中有效地提取原始数据信息**。【框架核心】
	- 训练目标是最小化重构数据与原始数据之间的差异，其损失函数通常定义为：

$$\arg\min_{\theta_g}\|g(f_k(x_k))-x_k\|^2\tag{2}$$
	其中，$f_k$ 是参与方的底层模型，$x_k$ 是原始私有数据，$\theta_g$ 表示逆向网络 $g$ 的参数。

- 数据准备和模型准备：根据攻击者的能力，提出了不同数据准备和模型准备方法。（为了克服在实际 VFL 场景中难以直接获得私有数据和底层模型的限制而设计的步骤。）
	- 数据准备：
		- 如果攻击者拥有与目标数据相同分布的辅助数据集，可以直接用它来训练 InverNet。
		- 如果没有，可以使用数据生成器基于先验信息（数据分布特性）生成合成数据。
	- 模型准备：
		- 如果攻击者能够对目标方发起推理查询，那么可以直接从这些查询中获取到底层模型的输出结果。
		- 如果攻击者无法对底层模型发起查询请求，那么攻击者可以选择训练一个影子模型来代替目标模型。通过使用已有的数据或合成数据，攻击者可以在本地训练出一个行为类似目标模型的影子模型，并用它来进行逆向网络的训练。

攻击场景：文章定义了四种攻击场景，包括查询攻击（Query Attack）、数据被动攻击（Data Passive Attack）、孤立查询攻击（Isolated Query Attack）和隐身攻击（Stealth Attack），每种场景下攻击者的能力不同。

![[attachments/Pasted image 20241022165704.png]]
表 1 ：对手的能力(✓：对手拥有这种能力；-：此功能是不必要的。)

### 四个攻击场景
#### 1、查询攻击（Query Attack）

- 不能访问目标方模型参数和梯度信息的能力；
- 可以对目标方发起查询请求，并且知道这些数据已经被用于 VFL 过程中。

![[attachments/Pasted image 20241022214925.png]]

**算法设计**（Algorithm 1: Query Attack）：

1. **函数定义**：`QueryAttack(ftarget, Htarget, Daux)`
2. **逆向网络训练**：使用辅助数据集 $D_{\text{aux}}$ 和目标模型 $f_{\text{target}}$ 来训练逆向网络 $g_{\text{target}}$。
3. **数据重建**：通过逆向网络 $g_{\text{target}}$ 对中间特征 $H_{\text{target}}$ 进行处理，得到估计的原始私有数据 $\hat{x}_{\text{target}}$。

**具体步骤**：

- 初始化逆向网络 $g_{\text{target}}$。
- 在每次迭代中，从私有数据集中抽取泄露的样本 $x_1, x_2, \ldots, x_k$。
- 准备这些样本对应的中间特征数据 $H_i$。
- 计算损失 $L(g_{\text{target}}) = \frac{1}{m} \sum_{i=1}^m | g_{\text{target}}(H_i) - x_i |$。
- 更新逆向网络的参数 $\theta_g^{(n+1)} = \theta_g^{(n)} - \varepsilon \frac{\partial L(g_{\text{target}})}{\partial \theta_g^{(n)}}$。
- 重复上述过程直到达到预设的迭代次数 $N_{\text{Iters}}$。

#### 2、数据被动攻击（Data Passive Attack）

- 攻击者拥有一个与目标方私有数据具有相同独立同分布（i.i.d.）特征的辅助数据集 $D_{\mathrm{aux}}$ ；
- 攻击者无法直接查询目标模型。

![[attachments/Pasted image 20241022214939.png]]

**算法设计**（Algorithm 2: Data Passive Attack）：

1. **函数定义**：`DataPassiveAttack(ftarget, Htarget, Daux)`
2. **影子模型训练**：使用辅助数据集 $D_{\text{aux}}$ 和顶层模型 $f_{\text{top}}$ 来训练影子模型 $\tilde{f}_{\text{target}}$。
3. **逆向网络训练**：利用辅助数据集 $D_{\text{aux}}$ 和影子模型 $\tilde{f}_{\text{target}}$ 来训练逆向网络 $g_{\text{target}}$。
4. **数据重建**：通过逆向网络 $g_{\text{target}}$ 对中间特征 $H_{\text{target}}$ 进行处理，得到估计的原始私有数据 $\hat{x}_{\text{target}}$。

**影子模型训练的具体步骤**：

- 初始化影子模型 $\tilde{f}_{\text{target}}$。
- 随机抽样 $x_1, x_2, \ldots, x_k$ 及其标签 $y_1, y_2, \ldots, y_k$ 从辅助数据集 $D_{\text{aux}}$ 中。
- 使用顶层模型 $f_{\text{top}}$ 和当前影子模型 $\tilde{f}_{\text{target}}$ 的输出来计算预测值 $\hat{y}_i$。
- 计算损失 $L(\tilde{f}_{\text{target}}) = \frac{1}{k} \sum_{i=1}^k [y_i \log \hat{y}_i + (1 - y_i) \log (1 - \hat{y}_i)]$。
- 更新影子模型的参数 $\theta_{\tilde{f}}^{(n+1)} = \theta_{\tilde{f}}^{(n)} - \varepsilon \frac{\partial L(\tilde{f}_{\text{target}})}{\partial \theta_{\tilde{f}}^{(n)}}$。
- 重复上述过程直到达到预设的迭代次数 $N_{\text{Iters}}$。

#### 3、孤立查询攻击（Isolated Query Attack）

- 攻击者可以自由地对目标方发起查询请求，并拥有与目标方私有数据 i.i.d. 的辅助数据集 $D_{\mathrm{aux}}$ ；
- 攻击者无需进行额外的数据准备或模型准备工作。

![[attachments/Pasted image 20241022214955.png]]

**算法设计**（Algorithm 3: Isolated Query Attack）：

1. **函数定义**：`IsolatedQueryAttack(ftarget, Htarget, T)`
2. **生成合成数据**：
    - 使用数据生成模块创建一组合成数据 $D_{\text{fake}}$。对于表格数据，利用表头信息构造伪数据；对于分类变量，采用独热编码方法；对于连续变量，基于经验估计值范围并使用均匀分布进行随机采样。
3. **逆向网络训练**：
    - 使用生成的合成数据 $D_{\text{fake}}$ 和目标模型 $f_{\text{target}}$ 来训练逆向网络 $g_{\text{target}}$。
    - 训练过程中，逆向网络 $g_{\text{target}}$ 的目标是最小化重构误差。
4. **数据重建**：一旦逆向网络 $g_{\text{target}}$ 被充分训练，就可以用来从新的中间特征数据 $H_{\text{target}}$ 中恢复出原始私有数据 $\hat{x}_{\text{target}}$。

**具体步骤**（Algorithm 3: Isolated Query Attack）：

1. **定义函数**：`IsolatedQueryAttack(ftarget, Htarget, T)`
2. **生成合成数据**：根据数据类型或模板 T 生成合成数据 $D_{\text{fake}}$。
3. **训练逆向网络**：使用合成数据 $D_{\text{fake}}$ 和目标模型 $f_{\text{target}}$ 来训练逆向网络 $g_{\text{target}}$。
4. **数据重建**：使用训练好的逆向网络$g_{\text{target}}$对中间特征 $H_{\text{target}}$ 进行处理，得到估计的原始私有数据 $\hat{x}_{\text{target}}$。

#### 4、隐身攻击（Stealth Attack）

- 即使攻击者失去了辅助数据集的查询能力，仍然可以通过少量获取的目标方私有数据来进行数据重建。

![[attachments/Pasted image 20241022215007.png]]

**算法设计**（Algorithm 4: Stealth Attack）：

1. **函数定义**：`StealthAttack(Htarget, Dpriv)`。
2. **逆向网络训练**：使用少量获取的私有数据 $D_\mathrm{priv}$​ 来训练逆向网络 $g_\mathrm{target}$ 。
3. **数据重建**：通过逆向网络 $g_\mathrm{target}$ ​ 对中间特征 $H_\mathrm{target}$ ​ 进行处理，得到估计的原始私有数据 ​$\hat{x}_{\mathrm{target}}$ 。

**具体步骤**：

- 初始化逆向网络 $g_\mathrm{target}$ ​。
- 使用少量私有数据 $D_\mathrm{priv}$​​ 来训练逆向网络 $g_\mathrm{target}$ ​。
- 通过逆向网络 $g_\mathrm{target}$ ​ 处理中间特征 $H_\mathrm{target}$​ ，得到重构数据 $\hat{x}_{\mathrm{target}}$ ​。

#### 总结

- **查询攻击**：攻击者可以通过查询目标模型并使用辅助数据集来训练逆向网络，从而实现数据重建。
- **数据被动攻击**：攻击者通过训练影子模型来模拟目标模型的行为，然后用影子模型和辅助数据集来训练逆向网络。
- **孤立查询攻击**：攻击者可以直接查询目标模型并使用辅助数据集来训练逆向网络，无需额外的数据或模型准备。
- **隐蔽攻击**：即使攻击者没有辅助数据集和查询能力，也可以通过少量获取的私有数据来训练逆向网络并实现数据重建。

## Result

- **数据集**：Bank营销分析数据集、Adult收入数据集、信用违约数据集（Default of Credit Card Clients）和CIFAR-10图像数据集
- **模型实现**：对于表格数据，连续列进行了缩放处理，离散列进行了独热编码。对于图像数据，使用了PSNR（峰值信噪比）和SSIM（结构相似性指数）来衡量重建效果。
- **对比方法**：将UIFV方法与现有的一些先进技术进行了比较，如GRN（Gradient Reconstruction Network）和GIA（Gradient Inversion Attack）。

### 6.3 实验结果

- **不同场景下的表现**：
    - **查询攻击（QA）**：在放松的假设条件下，UIFV方法在Bank和Adult数据集上表现出色，整体、分类和连续变量的准确率均超过96%。例如，在Bank数据集上的连续变量准确率达到96.4% ± 0.2，在Adult数据集上的连续变量准确率达到98.8% ± 0.1。
    - **数据被动攻击（DPA）、孤立查询攻击（IQA）和隐蔽攻击（SA）**：这些场景下，UIFV方法也表现出较强的鲁棒性，大多数结果超过了60%的准确率。例如，在Bank数据集上，IQA和SA的准确率分别为66.2% ± 1.4和90.1% ± 0.1。
    - **图像数据集上的表现**：在CIFAR-10数据集上，UIFV方法在DPA场景下达到了最高的PSNR（25.61）和SSIM（0.89），显著优于其他方法（如黑盒方法的PSNR为19.81，SSIM为0.69）。

### 6.4 影响因素分析

- **数据生成的影响**：在IQA攻击场景中，数据生成模块（DG）对提高重构攻击的准确性有显著影响。与简单的随机数生成器相比，DG模块平均提高了30%的准确性。
- **已知私有数据集大小的影响**：在隐蔽攻击（SA）场景中，研究发现训练样本数量与准确性之间存在正相关关系。即使只有8个样本，UIFV方法仍然可以成功并产生合理的结果。
- **逆向网络模型大小的影响**：研究还探讨了逆向网络模型大小对攻击效果的影响。对于表格数据，使用三层全连接层；对于图像数据，使用两层转置卷积层。实验表明，增加网络层数可以提高性能，但存在饱和点。

【PS：这节GPT生成】


## Shortcome

# Self Thought

# 注释 (2024/10/21)



